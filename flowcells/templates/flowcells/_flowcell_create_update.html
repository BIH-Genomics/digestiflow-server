{% extends "projectroles/project_base.html" %}

{% load crispy_forms_tags %}
{% load render_bundle from webpack_loader %}

{% block navi_sub_project_extend %}
  <li class="breadcrumb-item">
    <a href="{% url 'flowcells:flowcell-list' project=project.sodar_uuid %}">Flow Cells</a>
  </li>
  {% if object.pk %}
    <li class="breadcrumb-item">
      <a href="{% url 'flowcells:flowcell-detail' project=project.sodar_uuid flowcell=object.sodar_uuid %}">
        {{ object.vendor_id }} ({{ object.label }})
      </a>
    </li>
    <li class="breadcrumb-item active">
      Update
    </li>
  {% else %}
    <li class="breadcrumb-item active">
      Create
    </li>
  {% endif %}
{% endblock %}

{% block title %}
  {% if object.pk %}
    Updating {{ object.vendor_id }} ({{ vendor.label }})
  {% else %}
    Create new Flow Cell in {{ project.title }}
  {% endif %}
{% endblock title %}

{% block projectroles %}
  <div class="row sodar-pr-content-title pb-2">
    {# Project menu dropdown, only visible if browser width < X and sidebar is hidden #}
    {% include 'projectroles/_project_menu_btn.html' %}

    <h2 class="sodar-pr-content-title">
      {% if object.pk %}
        Update
      {% else %}
        Create
      {% endif %}
      Flow Cell
    </h2>
  </div>

  <div class="container-fluid sodar-page-container">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" id="properties-tab" data-toggle="tab" href="#properties" aria-controls="properties" aria-selected="true">Properties</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="sample-sheet-tab" data-toggle="tab" href="#sample-sheet" aria-controls="sample-sheet" aria-selected="true">Sample Sheet</a>
      </li>
    </ul>

    <div class="tab-content border-left border-right border-bottom" id="flowcellTabContent">
      <div class="tab-pane show active" id="properties" role="tabpanel" aria-labelledby="properties-tab">
        <div class="row py-3">
          <div class="col">
            <form method="post">{% csrf_token %}
              {% if object.pk %}
                <div class="form-group">
                  <label class="form-control-label">UUID</label>
                  <div>
                    <input type="text" readonly class="form-control-plaintext" value="{{ object.sodar_uuid }}">
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-control-label">Project</label>
                  <div>
                    <input type="text" readonly class="form-control-plaintext" value="{{ object.project.title }}">
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-control-label">Created</label>
                  <div>
                    <input type="text" readonly class="form-control-plaintext" value="{{ object.date_created }}">
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-control-label">Last Update</label>
                  <div>
                    <input type="text" readonly class="form-control-plaintext" value="{{ object.date_modified }}">
                  </div>
                </div>
              {% endif %}
              {{ form|crispy }}

              <div class="text-right mb-3">
                <div class="btn-group" role="group">
                  <a role="button" class="btn btn-secondary"
                    {% if object.pk %}
                      href="{% url 'flowcells:flowcell-detail' project=project.sodar_uuid flowcell=object.sodar_uuid %}">
                    {% else %}
                      href="{% url 'flowcells:flowcell-list' project=project.sodar_uuid %}">
                    {% endif %}
                    <i class="fa fa-arrow-circle-left" aria-hidden="true"></i>
                    Cancel
                  </a>
                  <button type="submit" class="btn btn-primary">
                    <i class="fa fa-check" aria-hidden="true"></i>
                    {% if object.pk %}
                      Update
                    {% else %}
                      Create
                    {% endif %}
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="tab-pane" id="sample-sheet" role="tabpanel" aria-labelledby="sample-sheet-tab">
        <div class="row">
          <div class="col px-0">
            <div id="app" data-args="{&quot;project&quot;: &quot;{{ project.sodar_uuid }}&quot;}"></div>
            {% render_bundle 'app' 'js' 'FRONTEND' %}
          </div>
        </div>
      </div>
    </div>
  </div>

{% endblock %}
